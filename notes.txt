cat /etc/os-release

sudo apt-get update
sudo apt-get upgrade

## Building python 3.8.6 in google cloud shell
sudo apt install build-essential zlib1g-dev libncurses5-dev libgdbm-dev libnss3-dev libssl-dev libsqlite3-dev libreadline-dev libffi-dev curl libbz2-dev
curl -O https://www.python.org/ftp/python/3.8.6/Python-3.8.6.tar.xz
tar -xf Python-3.8.6.tar.xz
cd Python-3.8.6/
./configure --enable-optimizations --enable-loadable-sqlite-extensions
make -j 4
sudo make install
python3 -m pip install -U pip
### sudo make altinstall

sudo apt-get install python3-venv
python3 -m venv ~/.ark
source ~/.ark/bin/activate
pip3 install google-cloud-core -U
pip3 install google-cloud-storage -U
pip3 install google-cloud-bigquery -U
pip3 install pandas -U
pip3 freeze > requirements.txt

curl -X POST "https://us-central1-nw-msds498-ark-etf-analytics.cloudfunctions.net/ark-holdings-daily-pull" -H "Content-Type: application/json" --data "{}"
curl -O https://ark-funds.com/wp-content/fundsiteliterature/csv/ARK_INNOVATION_ETF_ARKK_HOLDINGS.csv 

curl https://ark-funds.com/wp-content/fundsiteliterature/csv/ARK_INNOVATION_ETF_ARKK_HOLDINGS.csv > ARKK_20201009.csv

pip3 install google-cloud-datastore -U

`gsutil cp dummy gs://nw-msds498-ark-etf-analytics/edited/dummy`
`gsutil mb gs://nw-msds498-ark-etf-analytics-raw`
`gsutil -m mv 'gs://nw-msds498-ark-etf-analytics/2020*' gs://nw-msds498-ark-holdings-raw`
`gsutil -m mv 'gs://nw-msds498-ark-etf-analytics/edited/*' gs://nw-msds498-ark-etf-analytics`

`gsutil ls -l gs://nw-msds498-ark-etf-analytics`

## New Buckets
gsutil mb gs://nw-msds498-ark-holdings-raw
gsutil mb gs://nw-msds498-ark-trades



## trigger cloud functions through command line
curl -X POST https://us-central1-nw-msds498-ark-etf-analytics.cloudfunctions.net/ark-holdings-daily-pull -H "Content-Type:application/json"  -d '{}'


##3 Enable venv:
sudo apt-get install python3-venv
python3 -m venv ~/.csv_loader
source ~/.csv_loader/bin/activate
pip3 install google-cloud-bigquery -U


source ~/.msds498GroupProject/bin/activate

Create new remote repo from existing local repo:
git remote add origin git@github.com:byegates/ark.git
git pull origin master --allow-unrelated-histories
git merge master

`1`gcloud iam service-accounts keys create ~/key.json  --iam-account ark-pull@nw-msds498-ark-etf-analytics.iam.gserviceaccount.com`

echo "" >> .gitignore
echo "# ignore key file which was used for dev/ut/debug" >> .gitignore
echo "pull/key.json" >> .gitignore


## Compute
gcloud projects list
gcloud functions list
gcloud buckets list
gcloud components list

gcloud compute instances list

gcloud compute instances update frontend-default-40682 --no-deletion-protection --zone asia-east2-c
gcloud compute instances update jenkins-default-5066 --no-deletion-protection --zone asia-east2-c

gcloud compute instances delete jenkins-default-5066 --zone asia-east2-c
gcloud compute instances delete frontend-default-40682 --zone asia-east2-c


## Mac python version management
https://opensource.com/article/19/5/python-3-default-mac

## pyenv virtual env management
https://realpython.com/intro-to-pyenv/
-- for Mac
brew install pyenv-virtualenv
